## Introducción
En este taller, vamos a correr una máquina con un montón de vulnerabilidades que se llama *Metasploitable2* y desde una con *Kali* vamos a intentar explotar esas vulnerabilidades.
Es interesante destacar que en Kali ya tenemos preinstaladas un montón de herramientas que vamos a utilizar.

Lo primero que vamos a hacer es descargarnos la máquina vulnerable [Metaspoitable2](https://www-2.dc.uba.ar/staff/rbaader/metasploitable2.ova) y luego la que corre con [Kali](https://cdimage.kali.org/kali-2025.3/kali-linux-2025.3-virtualbox-amd64.7z).

Luego de correrlas con Virtual Box, tenemos que chequear la conexión desde la máquina Kali a la Metasploitable2. Para sacar la ip, desde Metasplotable2 hacemos :
```bash 
ip addr
```
A continuación, vamos a logearnos en la máquina Kali, correr 
```bash
sudo su
```
y hacer 
```bash 
ping (ip)
```
Una vez que están conectadas, comenzamos.

## Objetivo Metasploitable2
Para esta sección, queremos escanear primero los puertos abiertos en Metasploitable2 desde Kali con ```nmap -sV (ip)```, en particular, la opción *sV* nos permite ver detalles de versión. Esto es particularmente importante, ya que vamos a abrir en la máquina Kali la herramienta **Metasploit** que la vamos a a encontrar en la esquina superior `03 - initialAccess > Metasploit Framework`, logearnos, y preguntarle si existe algún exploit para cierta versión. Para ello, usamos ```search (descripción)```. El tema es que si en *Metasploit* hay un exploit para vulnerar podemos usarlo. 

### Uso de exploit con metasploit
Una vez que encontramos un exploit en *Metasploit* tenemos que usarlo, o sea ```use (ruta al exploit) ```. Tenemos que ver qué parámetros necesitamos setear para realizar el ataque. Estos los vemos con ```show options ``` dentro del los cuáles, algunos son obligatorios (requiered). A continuación, los seteamos con ```set (parámetro) (valor) ```. Usando ```show options ``` vamos a ver que se seteo. Una vez que tenemos todos seteados, corremos ```exploit ```. 

#### Ejemplo 
Miramos con *nmap -sV (ip)* :
![nmap](https://github.com/ToniusRetonius/SegInf/blob/main/Talleres/Taller%202%20-%20pentest/Capturas/telnet.png)

Vemos que en el *puerto 21* hay un servicio ftp corriendo con versión *vsftpd 2.3.4* con lo cual, nos vamos a la herramienta *Metasploit* para chequear si tiene algún exploit que podamos usar :

![search](https://github.com/ToniusRetonius/SegInf/blob/main/Talleres/Taller%202%20-%20pentest/Capturas/search.png)

Con esto, como encontramos uno, lo tenemos que usar y corremos ```use (ruta al exploit) ``` y seteamos los parámetros :

![set](https://github.com/ToniusRetonius/SegInf/blob/main/Talleres/Taller%202%20-%20pentest/Capturas/set.png)

Y finalmente, *exploit*. A partir de este momento, estamos dentro de la máquina con privilegios de root, para chequear corremos :
```id```

## Nikto
Otra herramienta que nos provee Kali es *Nikto*. Nikto es un Web Server Scanner que revisa servidores web en busca de configuraciones inseguras, versiones desactualizadas, vulnerabilidades conocidas y archivos expuestos. Para usarlo, corremos
```nikto -host (ip del target) ```
Con esto, podemos detectar que hay rutas visibles, como */doc* con lo cual, podemos abrir un navegador y chusmearla :
![/doc](https://github.com/ToniusRetonius/SegInf/blob/main/Talleres/Taller%202%20-%20pentest/Capturas/nikto2.png)

## Dirb
**dirb** es un scanner de directorios y ficheros web que funciona por fuerza bruta usando wordlists. Su objetivo es encontrar rutas ocultas (directorios, ficheros) en un servidor web que no aparecen en la navegación normal. Ejemplo de uso
``` dirb http://objetivo.com ```

## Gobuster
**Gobuster** puede hacer principalmente tres cosas (según el *mode* que elijas):

- **dir** — fuerza bruta de directorios y ficheros en un servidor web (equivalente a `dirb`).  
- **vhost** — prueba *virtual hosts* (cabecera `Host:` distinta) para detectar hostnames virtuales en el mismo servidor.  
- **dns** — fuerza bruta de subdominios (consulta DNS) contra un dominio.

### Opciones útiles:

- `-u <url>` — URL objetivo.
- `-w <wordlist>` — ruta a la wordlist.
- `-t <threads>` — cantidad de hilos (ej. `-t 50`).
- `-x <extensiones>` — buscar con extensiones, p.ej. `-x php,html,txt`.
- `-s <statuscodes>` — mostrar solo ciertos códigos (ej. `-s 200,301,302,403`).
- `-o <archivo>` — guardar salida.
- `-e` — imprimir la URL completa encontrada (útil).
- `-k` — ignorar verificación TLS (si https y certificado self-signed).


### Ejemplo de uso (dir mode)
```gobuster dir -u https://target.com -w Wordlists/common.txt -x php,html,js -s 200,301,302,403 -o gobuster_dir.txt -e ```


## Hydra
Hydra es una herramienta de brute force para autenticación remota, o sea intenta combinaciones de usuario/contraseña contra muchos servicios (SSH, FTP, HTTP(S) forms, SMB, RDP, POP3, IMAP, VNC, databases, etc.). Soporta múltiples hilos y permite usar wordlists, listas de usuarios, o generadores de contraseñas.

### Opciones útiles

- `-l <user>` — usuario único.  
- `-L <users.txt>` — lista de usuarios.  
- `-p <pass>` — una contraseña única.  
- `-P <passwords.txt>` — lista de contraseñas.  
- `-t <tasks>` — hilos / concurrencia (ej. `-t 16`).  
- `-s <port>` — puerto si no es el por defecto.  
- `-M <hosts.txt>` — archivo con múltiples hosts (ataque distribuido).  
- `-x <min:max:charset>` — generar contraseñas por fuerza bruta (ej. `-x 6:8:azA1`).  
- `-f` — detenerse cuando encuentra una credencial válida para el servicio.  
- `-V` — modo verbose (muestra intentos).  
- `-o <archivo>` — guardar resultados en archivo.  
- `-I` — ignora límites de tasa (útil pero arriesgado).  
- `-S` — use SSL (dependiendo del módulo/protocolo).  
- `-u` — vuelve a probar el mismo usuario/contraseña en caso de error (flag según versión).  


### Ejemplo 1 (SSH): usuario - lista contraseñas 
``` hydra -l admin -P wordlists/rockyou.txt ssh://10.0.0.5 -t 6 -f -o hydra_ssh.txt -V ```
### Ejemplo 2 (FTP) : lista de usuarios - lista contraseñas 
``` hydra -L users.txt -P passwords.txt ftp://192.168.1.50 -t 8 -o hydra_ftp.txt ```


## Links útiles
- [Walkthrough](https://rajeshmenghwar.medium.com/introduction-abdc1c5cd41b)

- [Metasploit Cheat-sheet](https://github.com/ToniusRetonius/SegInf/blob/main/Talleres/Taller%202%20-%20pentest/metasploit%20cheat-sheet.pdf)

- [Diccionarios](https://github.com/danielmiessler/SecLists/tree/master/Passwords)

- [NSE Scripts NMAP](https://nmap.org/nsedoc/scripts/)